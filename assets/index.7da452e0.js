var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,o=(e,o)=>{for(var a in o||(o={}))r.call(o,a)&&n(e,a,o[a]);if(t)for(var a of t(o))s.call(o,a)&&n(e,a,o[a]);return e};import{a,v as u,s as l,l as i,t as f,b as c,i as h,r as p,w as v,o as d,c as y,d as x,u as m,e as g,F as A,f as b,g as C,h as P,p as w,P as _,j as k}from"./vendor.cd3ae8d6.js";class S extends Error{constructor(e,t){super(e),this.info=t,Error.captureStackTrace&&Error.captureStackTrace(this,S)}}var j=Object.defineProperty,M=Object.getOwnPropertyDescriptor,O=(e,t,r,s)=>{for(var n,o=s>1?void 0:s?M(t,r):t,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s?n(t,r,o):n(o))||o);return s&&o&&j(t,r,o),o};const E=class{constructor(e=[],t,r){this.opts={},this.layerdStates=e,this.parent=t,this.name=r||(1===e.length?"<root>":"<anonymous>")}log(e,t){this.parent?this.parent.log(e,t):this.opts.log&&this.opts.log(e,t)}onUpdated(e,t){this.parent?this.parent.onUpdated(e,t):this.opts.onUpdated&&this.opts.onUpdated(e,t)}createChildScope(e=new Map,t){const r=[e,...this.layerdStates];return new E(r,this,t)}get(e){for(const t of this.layerdStates)if(t.has(e)){const r=t.get(e);return this.log("read",{var:e,val:r}),r}throw new S(`No such variable '${e}' in scope '${this.name}'`,{scope:this.layerdStates})}add(e,t){if(this.log("add",{var:e,val:t}),this.layerdStates[0].has(e))throw new S(`Variable '${e}' is alerady exists in scope '${this.name}'`,{scope:this.layerdStates});this.layerdStates[0].set(e,t),null==this.parent&&this.onUpdated(e,t)}assign(e,t){let r=1;for(const s of this.layerdStates){if(s.has(e))return s.set(e,t),this.log("assign",{var:e,val:t}),void(r===this.layerdStates.length&&this.onUpdated(e,t));r++}throw new S(`No such variable '${e}' in scope '${this.name}'`,{scope:this.layerdStates})}};let $=E;O([a],$.prototype,"log",1),O([a],$.prototype,"onUpdated",1),O([a],$.prototype,"createChildScope",1),O([a],$.prototype,"get",1),O([a],$.prototype,"add",1),O([a],$.prototype,"assign",1);const N={type:"null"},D={type:"bool",value:!0},H={type:"bool",value:!1},q=e=>({type:"num",value:e}),F=e=>({type:"str",value:e}),I=e=>({type:"bool",value:e}),z=e=>({type:"obj",value:e}),U=e=>({type:"arr",value:e}),R=e=>({type:"fn",native:e});function T(e){if("bool"!==e.type)throw new S(`Expect boolean, but got ${e.type}.`)}function J(e){if("fn"!==e.type)throw new S(`Expect function, but got ${e.type}.`)}function Z(e){if("str"!==e.type)throw new S(`Expect string, but got ${e.type}.`)}function B(e){if("num"!==e.type)throw new S(`Expect number, but got ${e.type}.`)}function V(e){if("obj"!==e.type)throw new S(`Expect object, but got ${e.type}.`)}function L(e){if("arr"!==e.type)throw new S(`Expect array, but got ${e.type}.`)}function Y(e,t){return"fn"!==e.type&&"fn"!==t.type&&("null"===e.type&&"null"===t.type||"null"!==e.type&&"null"!==t.type&&e.value===t.value)}function G(e,t=!1){if(t){if("num"===e.type)return e.value;if("bool"===e.type)return e.value?"yes":"no";if("str"===e.type)return`"${e.value}"`;if("arr"===e.type)return`[${e.value.map((e=>G(e,!0))).join(", ")}]`;if("null"===e.type)return"(null)"}const r="num"===e.type||"bool"===e.type?e.value:"str"===e.type?`"${e.value}"`:"fn"===e.type||"obj"===e.type?"...":"null"===e.type?"":null;return`${e.type}<${r}>`}function K(e){switch(e.type){case"arr":return e.value.map((e=>K(e)));case"bool":return e.value;case"null":return null;case"num":return e.value;case"obj":{const t={};for(const[r,s]of e.value.entries())t[r]=K(s);return t}case"str":return e.value;default:return}}function Q(e){if(null===e)return N;if("boolean"==typeof e)return I(e);if("string"==typeof e)return F(e);if("number"==typeof e)return q(e);if(Array.isArray(e))return U(e.map((e=>Q(e))));if("object"==typeof e){const t=new Map;for(const[r,s]of Object.entries(e))t.set(r,Q(s));return z(t)}return N}const W={help:F("SEE: https://github.com/syuilo/aiscript/blob/master/docs/get-started.md"),"Core:v":F("0.11.1"),"Core:ai":F("kawaii"),"Core:not":R((([e])=>(T(e),e.value?H:D))),"Core:eq":R((([e,t])=>Y(e,t)?D:H)),"Core:neq":R((([e,t])=>Y(e,t)?H:D)),"Core:and":R((([e,t])=>(T(e),T(t),e.value&&t.value?D:H))),"Core:or":R((([e,t])=>(T(e),T(t),e.value||t.value?D:H))),"Core:add":R((([e,t])=>(B(e),B(t),q(e.value+t.value)))),"Core:sub":R((([e,t])=>(B(e),B(t),q(e.value-t.value)))),"Core:mul":R((([e,t])=>(B(e),B(t),q(e.value*t.value)))),"Core:div":R((([e,t])=>{B(e),B(t);const r=e.value/t.value;if(isNaN(r))throw new S("Invalid operation.");return q(r)})),"Core:mod":R((([e,t])=>(B(e),B(t),q(e.value%t.value)))),"Core:gt":R((([e,t])=>(B(e),B(t),e.value>t.value?D:H))),"Core:lt":R((([e,t])=>(B(e),B(t),e.value<t.value?D:H))),"Core:gteq":R((([e,t])=>(B(e),B(t),e.value>=t.value?D:H))),"Core:lteq":R((([e,t])=>(B(e),B(t),e.value<=t.value?D:H))),"Core:type":R((([e])=>F(e.type))),"Core:to_str":R((([e])=>"str"===e.type?e:"num"===e.type?F(e.value.toString()):F("?"))),"Core:range":R((([e,t])=>(B(e),B(t),e.value<t.value?U(Array.from({length:t.value-e.value+1},((t,r)=>q(r+e.value)))):e.value>t.value?U(Array.from({length:e.value-t.value+1},((t,r)=>q(e.value-r)))):U([e])))),"Util:uuid":R((()=>F(u()))),"Json:stringify":R((([e])=>F(JSON.stringify(K(e))))),"Json:parse":R((([e])=>(Z(e),Q(JSON.parse(e.value))))),"Date:now":R((()=>q(Date.now()))),"Date:year":R((()=>q((new Date).getFullYear()))),"Date:month":R((()=>q((new Date).getMonth()+1))),"Date:day":R((()=>q((new Date).getDate()))),"Date:hour":R((()=>q((new Date).getHours()))),"Date:minute":R((()=>q((new Date).getMinutes()))),"Date:second":R((()=>q((new Date).getSeconds()))),"Date:parse":R((([e])=>(Z(e),q(new Date(e.value).getTime())))),"Math:PI":q(Math.PI),"Math:sin":R((([e])=>(B(e),q(Math.sin(e.value))))),"Math:cos":R((([e])=>(B(e),q(Math.cos(e.value))))),"Math:abs":R((([e])=>(B(e),q(Math.abs(e.value))))),"Math:sqrt":R((([e])=>{B(e);const t=Math.sqrt(e.value);if(isNaN(t))throw new S("Invalid operation.");return q(t)})),"Math:round":R((([e])=>(B(e),q(Math.round(e.value))))),"Math:floor":R((([e])=>(B(e),q(Math.floor(e.value))))),"Math:min":R((([e,t])=>(B(e),B(t),q(Math.min(e.value,t.value))))),"Math:max":R((([e,t])=>(B(e),B(t),q(Math.max(e.value,t.value))))),"Math:rnd":R((([e,t])=>e&&"num"===e.type&&t&&"num"===t.type?q(Math.floor(Math.random()*(t.value-e.value+1)+e.value)):q(Math.random()))),"Math:gen_rng":R((([e])=>{if("num"!==e.type&&"str"!==e.type)return N;const t=l(e.value.toString());return R((([e,r])=>e&&"num"===e.type&&r&&"num"===r.type?q(Math.floor(t()*(r.value-e.value+1)+e.value)):q(t())))})),"Num:to_hex":R((([e])=>(B(e),F(e.value.toString(16))))),"Num:from_hex":R((([e])=>(Z(e),q(parseInt(e.value,16))))),"Str:lf":F("\n"),"Str:to_num":R((([e])=>{if("num"===e.type)return e;if("str"===e.type){const t=parseInt(e.value,10);return isNaN(t)?N:q(t)}return N})),"Str:len":R((([e])=>"str"!==e.type?q(0):q(i(e.value)))),"Str:pick":R((([e,t])=>{Z(e),B(t);const r=f(e.value)[t.value-1];return r?F(r):N})),"Str:incl":R((([e,t])=>(Z(e),Z(t),e.value.includes(t.value)?D:H))),"Str:slice":R((([e,t,r])=>(Z(e),B(t),B(r),F(c(e.value,t.value-1,r.value-1))))),"Str:split":R((([e,t])=>(Z(e),t&&Z(t),U(t?e.value.split(t?t.value:"").map((e=>F(e))):f(e.value).map((e=>F(e))))))),"Str:replace":R((([e,t,r])=>(Z(e),Z(t),Z(r),F(e.value.split(t.value).join(r.value))))),"Str:index_of":R((([e,t])=>(Z(e),Z(t),q(h(e.value,t.value)+1)))),"Str:trim":R((([e])=>(Z(e),F(e.value.trim())))),"Str:upper":R((([e])=>(Z(e),F(e.value.toUpperCase())))),"Str:lower":R((([e])=>(Z(e),F(e.value.toLowerCase())))),"Arr:len":R((([e])=>"arr"!==e.type?q(0):q(e.value.length))),"Arr:push":R((([e,t])=>(L(e),e.value.push(t),N))),"Arr:unshift":R((([e,t])=>(L(e),e.value.unshift(t),N))),"Arr:pop":R((([e])=>(L(e),e.value.pop()))),"Arr:shift":R((([e])=>(L(e),e.value.shift()))),"Arr:concat":R((([e,t])=>(L(e),L(t),U(e.value.concat(t.value))))),"Arr:join":R((([e,t])=>(L(e),t&&Z(t),F(e.value.map((e=>"str"===e.type?e.value:"")).join(t?t.value:""))))),"Arr:slice":R((([e,t,r])=>(L(e),B(t),B(r),U(e.value.slice(t.value-1,r.value-1))))),"Arr:incl":R((([e,t])=>{if(L(e),"str"!==t.type&&"num"!==t.type&&"bool"!==t.type&&"null"!==t.type)return H;return(r=e,r.value.map((e=>"str"===e.type||"num"===e.type||"bool"===e.type?e.value:"null"===e.type?null:Symbol()))).includes("null"===t.type?null:t.value)?D:H;var r})),"Arr:map":R((async([e,t],r)=>{L(e),J(t);const s=e.value.map((async(e,s)=>await r.call(t,[e,q(s+1)])));return U(await Promise.all(s))})),"Arr:filter":R((async([e,t],r)=>{L(e),J(t);const s=[];for(let n=0;n<e.value.length;n++){const o=e.value[n],a=await r.call(t,[o,q(n+1)]);T(a),a.value&&s.push(o)}return U(s)})),"Arr:reduce":R((async([e,t,r],s)=>{L(e),J(t);const n=null!=r;let o=n?r:e.value[0];for(let a=n?0:1;a<e.value.length;a++){const r=e.value[a];o=await s.call(t,[o,r,q(a+1)])}return o})),"Arr:find":R((async([e,t],r)=>{L(e),J(t);for(let s=0;s<e.value.length;s++){const n=e.value[s],o=await r.call(t,[n,q(s+1)]);if(T(o),o.value)return n}return N})),"Arr:reverse":R((([e])=>(L(e),e.value.reverse(),N))),"Arr:copy":R((async([e])=>(L(e),U([...e.value])))),"Obj:keys":R((([e])=>(V(e),U(Array.from(e.value.keys()).map((e=>F(e))))))),"Obj:kvs":R((([e])=>(V(e),U(Array.from(e.value.entries()).map((([e,t])=>U([F(e),t]))))))),"Obj:get":R((([e,t])=>(V(e),Z(t),e.value.get(t.value)||N))),"Obj:set":R((([e,t,r])=>(V(e),Z(t),e.value.set(t.value,r),N))),"Obj:has":R((([e,t])=>(V(e),Z(t),I(e.value.has(t.value))))),"Obj:copy":R((([e])=>(V(e),z(new Map(e.value))))),"Async:interval":R((async([e,t,r],s)=>{B(e),J(t),r&&T(r),r&&s.call(t,[]);const n=setInterval((()=>{s.call(t,[])}),e.value),o=()=>{clearInterval(n)};return s.registerAbortHandler(o),R((([],e)=>{clearInterval(n),e.unregisterAbortHandler(o)}))})),"Async:timeout":R((async([e,t],r)=>{B(e),J(t);const s=setTimeout((()=>{r.call(t,[])}),e.value),n=()=>{clearTimeout(s)};return r.registerAbortHandler(n),R((([],e)=>{clearTimeout(s),e.unregisterAbortHandler(n)}))}))};var X=Object.defineProperty,ee=Object.getOwnPropertyDescriptor,te=(e,t,r,s)=>{for(var n,o=s>1?void 0:s?ee(t,r):t,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s?n(t,r,o):n(o))||o);return s&&o&&X(t,r,o),o};class re{constructor(e,t){this.stepCount=0,this.stop=!1,this.abortHandlers=[],this.opts=t||{};const r={print:R((e=>{this.opts.out&&this.opts.out(e[0])})),readline:R((async e=>{const t=e[0];if(Z(t),null==this.opts.in)return N;const r=await this.opts.in(t.value);return F(r)}))};this.vars=o(o(o({},e),W),r),this.scope=new $([new Map(Object.entries(this.vars))]),this.scope.opts.log=(e,t)=>{switch(e){case"add":this.log("var:add",t);break;case"read":this.log("var:read",t);break;case"write":this.log("var:write",t)}}}async exec(e){if(null==e||0===e.length)return;await this.collectNs(e);const t=await this._run(e,this.scope);this.log("end",{val:t})}async execFn(e,t){return this._fn(e,t)}static collectMetadata(e){if(null==e||0===e.length)return;function t(e){switch(e.type){case"arr":return e.value.map((e=>t(e)));case"bool":return e.value;case"null":return null;case"num":return e.value;case"obj":{const r={};for(const[s,n]of e.value.entries())r[s]=t(n);return r}case"str":return e.value}}const r=new Map;for(const s of e)switch(s.type){case"meta":r.set(s.name,t(s.value))}return r}log(e,t){this.opts.log&&this.opts.log(e,t)}async collectNs(e){for(const t of e)switch(t.type){case"ns":await this.collectNsMember(t)}}async collectNsMember(e){const t=this.scope.createChildScope();for(const r of e.members)switch(r.type){case"def":{const s=await this._eval(r.expr,t);t.add(r.name,s),this.scope.add(e.name+":"+r.name,s);break}case"ns":break;default:throw new Error("invalid ns member type: "+r.type)}}async _fn(e,t){if(e.native){return await Promise.resolve(e.native(t,{call:this._fn,registerAbortHandler:this.registerAbortHandler,unregisterAbortHandler:this.unregisterAbortHandler}))||N}{const s=new Map;for(let r=0;r<(e.args||[]).length;r++)s.set(e.args[r],t[r]);const n=e.scope.createChildScope(s);return"return"===(r=await this._run(e.statements,n)).type?r.value:r}var r}async _eval(e,t){if(this.stop)return N;if(this.log("node",{node:e}),this.stepCount++,this.opts.maxStep&&this.stepCount>this.opts.maxStep)throw new S("max step exceeded");switch(e.type){case"call":{const r=t.get(e.name);J(r);const s=await Promise.all(e.args.map((async e=>await this._eval(e,t))));return this._fn(r,s)}case"if":{const r=await this._eval(e.cond,t);if(T(r),r.value)return this._eval(e.then,t);if(e.elseif&&e.elseif.length>0){for(const r of e.elseif){const e=await this._eval(r.cond,t);if(T(e),e.value)return this._eval(r.then,t)}if(e.else)return this._eval(e.else,t)}else if(e.else)return this._eval(e.else,t);return N}case"match":{const r=await this._eval(e.about,t);for(const s of e.qs){if(Y(r,await this._eval(s.q,t)))return await this._eval(s.a,t)}return e.default?await this._eval(e.default,t):N}case"loop":for(;;){if("break"===(await this._run(e.statements,t.createChildScope())).type)break}return N;case"for":if(e.times){const r=await this._eval(e.times,t);B(r);for(let s=1;s<r.value+1;s++){if("break"===(await this._eval(e.for,t)).type)break}}else{const r=await this._eval(e.from,t),s=await this._eval(e.to,t);B(r),B(s);for(let n=r.value+1;n<s.value+1;n++){if("break"===(await this._eval(e.for,t.createChildScope(new Map([[e.var,q(n)]])))).type)break}}return N;case"forOf":{const r=await this._eval(e.items,t);L(r);for(const s of r.value)await this._eval(e.for,t.createChildScope(new Map([[e.var,s]])));return N}case"def":return t.add(e.name,await this._eval(e.expr,t)),N;case"var":return t.get(e.name);case"assign":return t.assign(e.name,await this._eval(e.expr,t)),N;case"propAssign":{let r=t.get(e.obj);const s=e.path[e.path.length-1];for(const t of e.path.slice(0,e.path.length-1)){if(V(r),!r.value.has(t)){r=N;break}r=r.value.get(t)}return V(r),r.value.set(s,await this._eval(e.expr,t)),N}case"indexAssign":{const r=t.get(e.arr);L(r);const s=await this._eval(e.i,t);return B(s),r.value[s.value-1]=await this._eval(e.expr,t),N}case"inc":{const r=t.get(e.name);B(r);const s=await this._eval(e.expr,t);return B(s),r.value+=s.value,N}case"dec":{const r=t.get(e.name);B(r);const s=await this._eval(e.expr,t);return B(s),r.value-=s.value,N}case"null":return N;case"bool":return I(e.value);case"num":return q(e.value);case"str":return F(e.value);case"arr":return U(await Promise.all(e.value.map((async e=>await this._eval(e,t)))));case"obj":{const r=new Map;for(const s of e.value.keys())r.set(s,await this._eval(e.value.get(s),t));return z(r)}case"prop":{let r=t.get(e.obj);for(const t of e.path){if(V(r),!r.value.has(t)){r=N;break}r=r.value.get(t)}return r}case"propCall":{let r=t.get(e.obj);for(const t of e.path){if(V(r),!r.value.has(t)){r=N;break}r=r.value.get(t)}J(r);const s=await Promise.all(e.args.map((async e=>await this._eval(e,t))));return this._fn(r,s)}case"index":{const r=t.get(e.arr);L(r);const s=await this._eval(e.i,t);return B(s),r.value[s.value-1]}case"fn":return((e,t,r)=>({type:"fn",args:e,statements:t,scope:r}))(e.args,e.children,t);case"block":return this._run(e.statements,t.createChildScope());case"tmpl":{let r="";for(const s of e.tmpl)if("string"==typeof s)r+=s;else{const e=await this._eval(s,t);let n="";"str"===e.type?n=e.value:"num"===e.type&&(n=e.value.toString()),r+=n}return F(r)}case"infix":{let r=await this._eval(e.operands[0],t);for(let s=0;s<e.operators.length;s++){const n=await this._eval(e.operands[s+1],t),o=await this._eval(e.operators[s],t);J(o),r=await this._fn(o,[r,n])}return r}case"operator":switch(e.op){case"+":return t.get("Core:add");case"-":return t.get("Core:sub");case"*":return t.get("Core:mul");case"/":return t.get("Core:div");case"%":return t.get("Core:mod");case"=":return t.get("Core:eq");case"!=":return t.get("Core:neq");case"&":return t.get("Core:and");case"|":return t.get("Core:or");case"<":return t.get("Core:lt");case">":return t.get("Core:gt");case"<=":return t.get("Core:lteq");case">=":return t.get("Core:gteq");default:throw new S(`No such operator: ${e.op}.`)}case"return":{const r=await this._eval(e.expr,t);return this.log("block:return",{scope:t.name,val:r}),{type:"return",value:r}}case"break":return this.log("block:break",{scope:t.name}),{type:"break",value:null};case"continue":return this.log("block:continue",{scope:t.name}),{type:"continue",value:null};case"ns":case"meta":return N;default:throw new Error("invalid node type")}}async _run(e,t){this.log("block:enter",{scope:t.name});let r=N;for(let s=0;s<e.length;s++){const n=e[s];if(r=await this._eval(n,t),"return"===r.type)return this.log("block:return",{scope:t.name,val:r.value}),r;if("break"===r.type)return this.log("block:break",{scope:t.name}),r;if("continue"===r.type)return this.log("block:continue",{scope:t.name}),r}return this.log("block:leave",{scope:t.name,val:r}),r}registerAbortHandler(e){this.abortHandlers.push(e)}unregisterAbortHandler(e){this.abortHandlers=this.abortHandlers.filter((t=>t!=e))}abort(){this.stop=!0;for(const e of this.abortHandlers)e();this.abortHandlers=[]}}function se(e,t,r,s){var n=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(n,se.prototype),n.expected=t,n.found=r,n.location=s,n.name="SyntaxError",n}function ne(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}te([a],re.prototype,"exec",1),te([a],re.prototype,"execFn",1),te([a],re.prototype,"log",1),te([a],re.prototype,"collectNs",1),te([a],re.prototype,"collectNsMember",1),te([a],re.prototype,"_fn",1),te([a],re.prototype,"_eval",1),te([a],re.prototype,"_run",1),te([a],re.prototype,"registerAbortHandler",1),te([a],re.prototype,"unregisterAbortHandler",1),te([a],re.prototype,"abort",1),te([a],re,"collectMetadata",1),function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(se,Error),se.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var r,s=null;for(r=0;r<e.length;r++)if(e[r].source===this.location.source){s=e[r].text.split(/\r\n|\n|\r/g);break}var n=this.location.start,o=this.location.source+":"+n.line+":"+n.column;if(s){var a=this.location.end,u=ne("",n.line.toString().length),l=s[n.line-1],i=n.line===a.line?a.column:l.length+1;t+="\n --\x3e "+o+"\n"+u+" |\n"+n.line+" | "+l+"\n"+u+" | "+ne("",n.column-1)+ne("",i-n.column,"^")}else t+="\n at "+o}return t},se.buildMessage=function(e,t){var r,s={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?a(e[0])+"-"+a(e[1]):a(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function u(e){return s[e.type](e)}return"Expected "+function(e){var t,r,s=e.map(u);if(s.sort(),s.length>0){for(t=1,r=1;t<s.length;t++)s[t-1]!==s[t]&&(s[r]=s[t],r++);s.length=r}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(e)+" but "+(((r=t)?'"'+o(r)+'"':"end of input")+" found.")},module.exports={SyntaxError:se,parse:function e(t,r){var s,n,o,a,u={},l=(r=void 0!==r?r:{}).grammarSource,i={Entry:or,Core:function(){var e,t,r,s,n,o=70*Vt+3,a=Wt[o];if(a)return Vt=a.nextPos,a.result;e=Vt,t=[],r=qr();for(;r!==u;)t.push(r),r=qr();(r=ur())===u&&(r=null);s=[],n=qr();for(;n!==u;)s.push(n),n=qr();return Lt=e,e=Ct(r),Wt[o]={nextPos:Vt,result:e},e}},f=or,c="//",h="(",p=")",v="{",d="}",y="###",x="#",m="=",g="<-",A="<:",b="<<<",C="#[",P="]",w="+",_="~~",k=",",S="each",j="~",M="for",O="return",E="loop",$="break",N="continue",D=".",H="[",q="+<-",F="-<-",I="=>",z="if",U="elif",R="else",T="match",J="`",Z="\\{",B="\\}",V="\\`",L='"',Y="yes",G="no",K="null",Q=":",W=";",X="@(",ee=/^[A-Z0-9_:]/i,te=/^[\-+*\/%&|=~<>!?]/,re=/^[+\-]/,ne=/^[1-9]/,oe=/^[0-9]/,ae=/^[A-Z_]/i,ue=/^[A-Z0-9_]/i,le=/^[\r\n]/,ie=/^[ \t\r\n]/,fe=/^[ \t]/,ce={type:"any"},he=er("//",!1),pe=er("(",!1),ve=er(")",!1),de=er("::",!1),ye=er("{",!1),xe=er("}",!1),me=er("###",!1),ge=er("#",!1),Ae=er("=",!1),be=er("$",!1),Ce=er("<-",!1),Pe=er("<:",!1),we=er("<<<",!1),_e=er("#[",!1),ke=er("]",!1),Se=er("+",!1),je=er("~~",!1),Me=er(",",!1),Oe=er("each",!1),Ee=er("~",!1),$e=er("for",!1),Ne=er("return",!1),De=er("loop",!1),He=er("break",!1),qe=tr([["A","Z"],["0","9"],"_",":"],!1,!0),Fe=er("continue",!1),Ie=er(".",!1),ze=er("[",!1),Ue=er("+<-",!1),Re=er("-<-",!1),Te=er("\\",!1),Je=er("=>",!1),Ze=tr(["-","+","*","/","%","&","|","=","~","<",">","!","?"],!1,!1),Be=er("if",!1),Ve=er("?",!1),Le=er("elif",!1),Ye=er("else",!1),Ge=er("match",!1),Ke=er("*",!1),Qe=er("`",!1),We=er("\\{",!1),Xe=er("\\}",!1),et=er("\\`",!1),tt=er('"',!1),rt=er('\\"',!1),st=tr(["+","-"],!1,!1),nt=tr([["1","9"]],!1,!1),ot=tr([["0","9"]],!1,!1),at=er("yes",!1),ut=er("no",!1),lt=er("-",!1),it=er("null",!1),ft=er(":",!1),ct=er(";",!1),ht=er("@",!1),pt=er("@(",!1),vt=tr([["A","Z"],"_"],!1,!0),dt=tr([["A","Z"],["0","9"],"_"],!1,!0),yt=er("\r\n",!1),xt=tr(["\r","\n"],!1,!1),mt=tr([" ","\t","\r","\n"],!1,!1),gt=tr([" ","\t"],!1,!1),At=function(t){return e(t.join(""),(r="Core")?{startRule:r}:{});var r},bt=function(){return Xt()},Ct=function(e){return e||[]},Pt=function(e,t){return t},wt=function(e,t){return[e,...t]},_t=function(e,t){return zr("attr",{name:e,value:t})},kt=function(e,t,r){return zr("forOf",{var:e,items:t,for:r})},St=function(e,t){return t},jt=function(e,t,r,s){return zr("for",{var:e,from:t||zr("num",{value:0}),to:r,for:s})},Mt=function(e,t){return zr("for",{times:e,for:t})},Ot=function(e,t){return t},Et=function(e,t,r){return{o:t,t:r}},$t=function(e,t,r){return r},Nt=function(e,t,r,s){return s},Dt=function(e,t,r,s){return zr("if",{cond:e,then:t,elseif:r||[],else:s})},Ht=function(e,t){return t},qt=function(e,t){return{cond:e,then:t}},Ft=function(e,t,r){return{q:t,a:r}},It=function(e,t){return t},zt=function(){return Xt()[1]},Ut=function(){return zr("num",{value:parseInt(Xt(),10)})},Rt=function(){return zr("bool",{value:!0})},Tt=function(){return zr("bool",{value:!1})},Jt=function(e,t){return{k:e,v:t}},Zt=function(e){const t=new Map;for(const r of e)t.set(r.k,r.v);return zr("obj",{value:t})},Bt=function(e){return zr("arr",{value:e})},Vt=0,Lt=0,Yt=[{line:1,column:1}],Gt=0,Kt=[],Qt=0,Wt={};if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');f=i[r.startRule]}function Xt(){return t.substring(Lt,Vt)}function er(e,t){return{type:"literal",text:e,ignoreCase:t}}function tr(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function rr(e){var r,s=Yt[e];if(s)return s;for(r=e-1;!Yt[r];)r--;for(s={line:(s=Yt[r]).line,column:s.column};r<e;)10===t.charCodeAt(r)?(s.line++,s.column=1):s.column++,r++;return Yt[e]=s,s}function sr(e,t){var r=rr(e),s=rr(t);return{source:l,start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:s.line,column:s.column}}}function nr(e){Vt<Gt||(Vt>Gt&&(Gt=Vt,Kt=[]),Kt.push(e))}function or(){var e,t,r,s=70*Vt+0,n=Wt[s];if(n)return Vt=n.nextPos,n.result;for(e=Vt,t=[],r=ar();r!==u;)t.push(r),r=ar();return Lt=e,e=t=At(t),Wt[s]={nextPos:Vt,result:e},e}function ar(){var e,r,s=70*Vt+1,n=Wt[s];return n?(Vt=n.nextPos,n.result):(e=Vt,(r=Pr())!==u&&(Lt=e,r=bt()),(e=r)===u&&(e=Vt,(r=_r())!==u&&(Lt=e,r=bt()),(e=r)===u&&(e=Vt,(r=function(){var e,r,s,n,o,a,l=70*Vt+2,i=Wt[l];if(i)return Vt=i.nextPos,i.result;e=Vt,t.substr(Vt,2)===c?(r=c,Vt+=2):(r=u,0===Qt&&nr(he));if(r!==u){for(s=[],n=Vt,o=Vt,Qt++,a=Hr(),Qt--,a===u?o=void 0:(Vt=o,o=u),o!==u?(t.length>Vt?(a=t.charAt(Vt),Vt++):(a=u,0===Qt&&nr(ce)),a!==u?n=o=[o,a]:(Vt=n,n=u)):(Vt=n,n=u);n!==u;)s.push(n),n=Vt,o=Vt,Qt++,a=Hr(),Qt--,a===u?o=void 0:(Vt=o,o=u),o!==u?(t.length>Vt?(a=t.charAt(Vt),Vt++):(a=u,0===Qt&&nr(ce)),a!==u?n=o=[o,a]:(Vt=n,n=u)):(Vt=n,n=u);e=r=[r,s]}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}())!==u&&(Lt=e,r=""),(e=r)===u&&(t.length>Vt?(e=t.charAt(Vt),Vt++):(e=u,0===Qt&&nr(ce))))),Wt[s]={nextPos:Vt,result:e},e)}function ur(){var e,t,r,s,n,o,a,l,i=70*Vt+4,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,(t=ir())!==u){for(r=[],s=Vt,n=[],o=Fr();o!==u;)n.push(o),o=Fr();if((o=Dr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=ir())!==u?(Lt=s,s=Pt(0,l)):(Vt=s,s=u)}else Vt=s,s=u;for(;s!==u;){for(r.push(s),s=Vt,n=[],o=Fr();o!==u;)n.push(o),o=Fr();if((o=Dr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=ir())!==u?(Lt=s,s=Pt(0,l)):(Vt=s,s=u)}else Vt=s,s=u}Lt=e,e=wt(t,r)}else Vt=e,e=u;return Wt[i]={nextPos:Vt,result:e},e}function lr(){var e,t,r,s,n,o,a,l,i=70*Vt+6,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,(t=cr())!==u){for(r=[],s=Vt,n=[],o=Fr();o!==u;)n.push(o),o=Fr();if((o=Dr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=cr())!==u?(Lt=s,s=Pt(0,l)):(Vt=s,s=u)}else Vt=s,s=u;for(;s!==u;){for(r.push(s),s=Vt,n=[],o=Fr();o!==u;)n.push(o),o=Fr();if((o=Dr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=cr())!==u?(Lt=s,s=Pt(0,l)):(Vt=s,s=u)}else Vt=s,s=u}Lt=e,e=wt(t,r)}else Vt=e,e=u;return Wt[i]={nextPos:Vt,result:e},e}function ir(){var e,r=70*Vt+7,s=Wt[r];return s?(Vt=s.nextPos,s.result):((e=dr())===u&&(e=function(){var e,r,s,n,o,a,l=70*Vt+15,i=Wt[l];if(i)return Vt=i.nextPos,i.result;e=Vt,t.substr(Vt,3)===y?(r=y,Vt+=3):(r=u,0===Qt&&nr(me));if(r!==u){for(s=[],n=Fr();n!==u;)s.push(n),n=Fr();if((n=$r())!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();(a=vr())!==u?(Lt=e,e=zr("meta",{name:n,value:a})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;if(e===u)if(e=Vt,t.substr(Vt,3)===y?(r=y,Vt+=3):(r=u,0===Qt&&nr(me)),r!==u){for(s=[],n=Fr();n!==u;)s.push(n),n=Fr();(n=vr())!==u?(Lt=e,e=function(e){return zr("meta",{name:null,value:e})}(n)):(Vt=e,e=u)}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}())===u&&(e=cr()),Wt[r]={nextPos:Vt,result:e},e)}function fr(){var e,t=70*Vt+8,r=Wt[t];return r?(Vt=r.nextPos,r.result):((e=yr())===u&&(e=Er())===u&&(e=dr()),Wt[t]={nextPos:Vt,result:e},e)}function cr(){var e,r=70*Vt+9,s=Wt[r];return s?(Vt=s.nextPos,s.result):((e=yr())===u&&(e=Er())===u&&(e=function(){var e,r,s,n,o=70*Vt+17,a=Wt[o];if(a)return Vt=a.nextPos,a.result;e=Vt,t.substr(Vt,2)===A?(r=A,Vt+=2):(r=u,0===Qt&&nr(Pe));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();(n=hr())!==u?(Lt=e,e=zr("call",{name:"print",args:[n]})):(Vt=e,e=u)}else Vt=e,e=u;return Wt[o]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o=70*Vt+18,a=Wt[o];if(a)return Vt=a.nextPos,a.result;e=Vt,t.substr(Vt,3)===b?(r=b,Vt+=3):(r=u,0===Qt&&nr(we));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();(n=hr())!==u?(Lt=e,e=zr("debug",{expr:n})):(Vt=e,e=u)}else Vt=e,e=u;return Wt[o]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o=70*Vt+22,a=Wt[o];if(a)return Vt=a.nextPos,a.result;e=Vt,t.substr(Vt,6)===O?(r=O,Vt+=6):(r=u,0===Qt&&nr(Ne));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();(n=hr())!==u?(Lt=e,e=zr("return",{expr:n})):(Vt=e,e=u)}else Vt=e,e=u;return Wt[o]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f=70*Vt+19,c=Wt[f];if(c)return Vt=c.nextPos,c.result;e=Vt,t.substr(Vt,2)===C?(r=C,Vt+=2):(r=u,0===Qt&&nr(_e));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if((n=$r())!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();if((a=vr())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();93===t.charCodeAt(Vt)?(i=P,Vt++):(i=u,0===Qt&&nr(ke)),i!==u?(Lt=e,e=_t(n,a)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u;if(e===u)if(e=Vt,43===t.charCodeAt(Vt)?(r="+",Vt++):(r=u,0===Qt&&nr(Se)),r!==u){for(s=[],n=Fr();n!==u;)s.push(n),n=Fr();if((n=$r())!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();(a=vr())!==u?(Lt=e,e=_t(n,a)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;return Wt[f]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,v,d,y,m=70*Vt+20,g=Wt[m];if(g)return Vt=g.nextPos,g.result;e=Vt,t.substr(Vt,2)===_?(r=_,Vt+=2):(r=u,0===Qt&&nr(je));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(40===t.charCodeAt(Vt)?(n=h,Vt++):(n=u,0===Qt&&nr(pe)),n!==u)if(35===t.charCodeAt(Vt)?(o=x,Vt++):(o=u,0===Qt&&nr(ge)),o!==u)if((a=$r())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();for(44===t.charCodeAt(Vt)?(i=k,Vt++):(i=u,0===Qt&&nr(Me)),i===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();if((c=hr())!==u)if(41===t.charCodeAt(Vt)?(v=p,Vt++):(v=u,0===Qt&&nr(ve)),v!==u){for(d=[],y=qr();y!==u;)d.push(y),y=qr();(y=cr())!==u?(Lt=e,e=kt(a,c,y)):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,t.substr(Vt,2)===_?(r=_,Vt+=2):(r=u,0===Qt&&nr(je)),r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if(35===t.charCodeAt(Vt)?(n=x,Vt++):(n=u,0===Qt&&nr(ge)),n!==u)if((o=$r())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();for(44===t.charCodeAt(Vt)?(l=k,Vt++):(l=u,0===Qt&&nr(Me)),l===u&&(l=null),i=[],f=qr();f!==u;)i.push(f),f=qr();if((f=hr())!==u){if(c=[],(v=qr())!==u)for(;v!==u;)c.push(v),v=qr();else c=u;c!==u&&(v=cr())!==u?(Lt=e,e=kt(o,f,v)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,t.substr(Vt,4)===S?(r=S,Vt+=4):(r=u,0===Qt&&nr(Oe)),r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(40===t.charCodeAt(Vt)?(n=h,Vt++):(n=u,0===Qt&&nr(pe)),n!==u)if(35===t.charCodeAt(Vt)?(o=x,Vt++):(o=u,0===Qt&&nr(ge)),o!==u)if((a=$r())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();for(44===t.charCodeAt(Vt)?(i=k,Vt++):(i=u,0===Qt&&nr(Me)),i===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();if((c=hr())!==u)if(41===t.charCodeAt(Vt)?(v=p,Vt++):(v=u,0===Qt&&nr(ve)),v!==u){for(d=[],y=qr();y!==u;)d.push(y),y=qr();(y=cr())!==u?(Lt=e,e=kt(a,c,y)):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u)if(e=Vt,t.substr(Vt,4)===S?(r=S,Vt+=4):(r=u,0===Qt&&nr(Oe)),r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if(35===t.charCodeAt(Vt)?(n=x,Vt++):(n=u,0===Qt&&nr(ge)),n!==u)if((o=$r())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();for(44===t.charCodeAt(Vt)?(l=k,Vt++):(l=u,0===Qt&&nr(Me)),l===u&&(l=null),i=[],f=qr();f!==u;)i.push(f),f=qr();if((f=hr())!==u){if(c=[],(v=qr())!==u)for(;v!==u;)c.push(v),v=qr();else c=u;c!==u&&(v=cr())!==u?(Lt=e,e=kt(o,f,v)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u}}return Wt[m]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,v,d,y,g,A=70*Vt+21,b=Wt[A];if(b)return Vt=b.nextPos,b.result;e=Vt,126===t.charCodeAt(Vt)?(r=j,Vt++):(r=u,0===Qt&&nr(Ee));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(40===t.charCodeAt(Vt)?(n=h,Vt++):(n=u,0===Qt&&nr(pe)),n!==u)if(35===t.charCodeAt(Vt)?(o=x,Vt++):(o=u,0===Qt&&nr(ge)),o!==u)if((a=$r())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();if(i=Vt,61===t.charCodeAt(Vt)?(f=m,Vt++):(f=u,0===Qt&&nr(Ae)),f!==u){for(c=[],v=qr();v!==u;)c.push(v),v=qr();(v=hr())!==u?(Lt=i,i=St(0,v)):(Vt=i,i=u)}else Vt=i,i=u;for(i===u&&(i=null),44===t.charCodeAt(Vt)?(f=k,Vt++):(f=u,0===Qt&&nr(Me)),f===u&&(f=null),c=[],v=qr();v!==u;)c.push(v),v=qr();if((v=hr())!==u)if(41===t.charCodeAt(Vt)?(d=p,Vt++):(d=u,0===Qt&&nr(ve)),d!==u){for(y=[],g=qr();g!==u;)y.push(g),g=qr();(g=cr())!==u?(Lt=e,e=jt(a,i,v,g)):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,126===t.charCodeAt(Vt)?(r=j,Vt++):(r=u,0===Qt&&nr(Ee)),r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if(35===t.charCodeAt(Vt)?(n=x,Vt++):(n=u,0===Qt&&nr(ge)),n!==u)if((o=$r())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();if(l=Vt,61===t.charCodeAt(Vt)?(i=m,Vt++):(i=u,0===Qt&&nr(Ae)),i!==u){for(f=[],c=qr();c!==u;)f.push(c),c=qr();(c=hr())!==u?(Lt=l,l=St(0,c)):(Vt=l,l=u)}else Vt=l,l=u;for(l===u&&(l=null),44===t.charCodeAt(Vt)?(i=k,Vt++):(i=u,0===Qt&&nr(Me)),i===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();if((c=hr())!==u){if(v=[],(d=qr())!==u)for(;d!==u;)v.push(d),d=qr();else v=u;v!==u&&(d=cr())!==u?(Lt=e,e=jt(o,l,c,d)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,126===t.charCodeAt(Vt)?(r=j,Vt++):(r=u,0===Qt&&nr(Ee)),r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(40===t.charCodeAt(Vt)?(n=h,Vt++):(n=u,0===Qt&&nr(pe)),n!==u)if((o=hr())!==u)if(41===t.charCodeAt(Vt)?(a=p,Vt++):(a=u,0===Qt&&nr(ve)),a!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();(i=cr())!==u?(Lt=e,e=Mt(o,i)):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,126===t.charCodeAt(Vt)?(r=j,Vt++):(r=u,0===Qt&&nr(Ee)),r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if((n=hr())!==u){if(o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;o!==u&&(a=cr())!==u?(Lt=e,e=Mt(n,a)):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,t.substr(Vt,3)===M?(r=M,Vt+=3):(r=u,0===Qt&&nr($e)),r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(40===t.charCodeAt(Vt)?(n=h,Vt++):(n=u,0===Qt&&nr(pe)),n!==u)if(35===t.charCodeAt(Vt)?(o=x,Vt++):(o=u,0===Qt&&nr(ge)),o!==u)if((a=$r())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();if(i=Vt,61===t.charCodeAt(Vt)?(f=m,Vt++):(f=u,0===Qt&&nr(Ae)),f!==u){for(c=[],v=qr();v!==u;)c.push(v),v=qr();(v=hr())!==u?(Lt=i,i=St(0,v)):(Vt=i,i=u)}else Vt=i,i=u;for(i===u&&(i=null),44===t.charCodeAt(Vt)?(f=k,Vt++):(f=u,0===Qt&&nr(Me)),f===u&&(f=null),c=[],v=qr();v!==u;)c.push(v),v=qr();if((v=hr())!==u)if(41===t.charCodeAt(Vt)?(d=p,Vt++):(d=u,0===Qt&&nr(ve)),d!==u){for(y=[],g=qr();g!==u;)y.push(g),g=qr();(g=cr())!==u?(Lt=e,e=jt(a,i,v,g)):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,t.substr(Vt,3)===M?(r=M,Vt+=3):(r=u,0===Qt&&nr($e)),r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if(35===t.charCodeAt(Vt)?(n=x,Vt++):(n=u,0===Qt&&nr(ge)),n!==u)if((o=$r())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();if(l=Vt,61===t.charCodeAt(Vt)?(i=m,Vt++):(i=u,0===Qt&&nr(Ae)),i!==u){for(f=[],c=qr();c!==u;)f.push(c),c=qr();(c=hr())!==u?(Lt=l,l=St(0,c)):(Vt=l,l=u)}else Vt=l,l=u;for(l===u&&(l=null),44===t.charCodeAt(Vt)?(i=k,Vt++):(i=u,0===Qt&&nr(Me)),i===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();if((c=hr())!==u){if(v=[],(d=qr())!==u)for(;d!==u;)v.push(d),d=qr();else v=u;v!==u&&(d=cr())!==u?(Lt=e,e=jt(o,l,c,d)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,t.substr(Vt,3)===M?(r=M,Vt+=3):(r=u,0===Qt&&nr($e)),r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(40===t.charCodeAt(Vt)?(n=h,Vt++):(n=u,0===Qt&&nr(pe)),n!==u)if((o=hr())!==u)if(41===t.charCodeAt(Vt)?(a=p,Vt++):(a=u,0===Qt&&nr(ve)),a!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();(i=cr())!==u?(Lt=e,e=Mt(o,i)):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u)if(e=Vt,t.substr(Vt,3)===M?(r=M,Vt+=3):(r=u,0===Qt&&nr($e)),r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if((n=hr())!==u){if(o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;o!==u&&(a=cr())!==u?(Lt=e,e=Mt(n,a)):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u}}}}}}return Wt[A]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f=70*Vt+23,c=Wt[f];if(c)return Vt=c.nextPos,c.result;e=Vt,t.substr(Vt,4)===E?(r=E,Vt+=4):(r=u,0===Qt&&nr(De));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(123===t.charCodeAt(Vt)?(n=v,Vt++):(n=u,0===Qt&&nr(ye)),n!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();if((a=lr())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();125===t.charCodeAt(Vt)?(i=d,Vt++):(i=u,0===Qt&&nr(xe)),i!==u?(Lt=e,e=zr("loop",{statements:a})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u;return Wt[f]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o=70*Vt+24,a=Wt[o];if(a)return Vt=a.nextPos,a.result;e=Vt,t.substr(Vt,5)===$?(r=$,Vt+=5):(r=u,0===Qt&&nr(He));r!==u?(s=Vt,Qt++,ee.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(qe)),Qt--,n===u?s=void 0:(Vt=s,s=u),s!==u?(Lt=e,e=zr("break",{})):(Vt=e,e=u)):(Vt=e,e=u);return Wt[o]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o=70*Vt+25,a=Wt[o];if(a)return Vt=a.nextPos,a.result;e=Vt,t.substr(Vt,8)===N?(r=N,Vt+=8):(r=u,0===Qt&&nr(Fe));r!==u?(s=Vt,Qt++,ee.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(qe)),Qt--,n===u?s=void 0:(Vt=s,s=u),s!==u?(Lt=e,e=zr("continue",{})):(Vt=e,e=u)):(Vt=e,e=u);return Wt[o]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l=70*Vt+26,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,(r=Nr())!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(t.substr(Vt,2)===g?(n=g,Vt+=2):(n=u,0===Qt&&nr(Ce)),n!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();(a=hr())!==u?(Lt=e,e=zr("assign",{name:r,expr:a})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i=70*Vt+27,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,(r=Nr())!==u){if(s=[],n=Vt,46===t.charCodeAt(Vt)?(o=D,Vt++):(o=u,0===Qt&&nr(Ie)),o!==u&&(a=$r())!==u?(Lt=n,n=Ot(0,a)):(Vt=n,n=u),n!==u)for(;n!==u;)s.push(n),n=Vt,46===t.charCodeAt(Vt)?(o=D,Vt++):(o=u,0===Qt&&nr(Ie)),o!==u&&(a=$r())!==u?(Lt=n,n=Ot(0,a)):(Vt=n,n=u);else s=u;if(s!==u){for(n=[],o=qr();o!==u;)n.push(o),o=qr();if(t.substr(Vt,2)===g?(o=g,Vt+=2):(o=u,0===Qt&&nr(Ce)),o!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=hr())!==u?(Lt=e,e=zr("propAssign",{obj:r,path:s,expr:l})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u;return Wt[i]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,h,p=70*Vt+28,v=Wt[p];if(v)return Vt=v.nextPos,v.result;if(e=Vt,(r=Nr())!==u)if(91===t.charCodeAt(Vt)?(s=H,Vt++):(s=u,0===Qt&&nr(ze)),s!==u){for(n=[],o=qr();o!==u;)n.push(o),o=qr();if((o=hr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();if(93===t.charCodeAt(Vt)?(l=P,Vt++):(l=u,0===Qt&&nr(ke)),l!==u){for(i=[],f=qr();f!==u;)i.push(f),f=qr();if(t.substr(Vt,2)===g?(f=g,Vt+=2):(f=u,0===Qt&&nr(Ce)),f!==u){for(c=[],h=qr();h!==u;)c.push(h),h=qr();(h=hr())!==u?(Lt=e,e=zr("indexAssign",{arr:r,i:o,expr:h})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;return Wt[p]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l=70*Vt+29,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,(r=Nr())!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(t.substr(Vt,3)===q?(n=q,Vt+=3):(n=u,0===Qt&&nr(Ue)),n!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();(a=hr())!==u?(Lt=e,e=zr("inc",{name:r,expr:a})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l=70*Vt+30,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,(r=Nr())!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(t.substr(Vt,3)===F?(n=F,Vt+=3):(n=u,0===Qt&&nr(Re)),n!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();(a=hr())!==u?(Lt=e,e=zr("dec",{name:r,expr:a})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}())===u&&(e=hr()),Wt[r]={nextPos:Vt,result:e},e)}function hr(){var e,t=70*Vt+10,r=Wt[t];return r?(Vt=r.nextPos,r.result):((e=function(){var e,t,r,s,n,o,a,l,i=70*Vt+31,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,(t=pr())!==u){for(r=[],s=Vt,n=[],o=xr();o!==u;)n.push(o),o=xr();if((o=mr())!==u){for(a=[],l=xr();l!==u;)a.push(l),l=xr();(l=pr())!==u?(Lt=s,s=Et(0,o,l)):(Vt=s,s=u)}else Vt=s,s=u;if(s!==u)for(;s!==u;){for(r.push(s),s=Vt,n=[],o=xr();o!==u;)n.push(o),o=xr();if((o=mr())!==u){for(a=[],l=xr();l!==u;)a.push(l),l=xr();(l=pr())!==u?(Lt=s,s=Et(0,o,l)):(Vt=s,s=u)}else Vt=s,s=u}else r=u;r!==u?(Lt=e,e=zr("infix",{operands:[t,...(c=r).map((e=>e.t))],operators:c.map((e=>e.o))})):(Vt=e,e=u)}else Vt=e,e=u;var c;return Wt[i]={nextPos:Vt,result:e},e}())===u&&(e=pr()),Wt[t]={nextPos:Vt,result:e},e)}function pr(){var e,r,s,n,o,a,l=70*Vt+11,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if((e=function(){var e,r,s,n,o,a,l,i,f,c,h=70*Vt+35,p=Wt[h];if(p)return Vt=p.nextPos,p.result;e=Vt,t.substr(Vt,2)===z?(r=z,Vt+=2):(r=u,0===Qt&&nr(Be));if(r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if((n=hr())!==u){if(o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;if(o!==u)if((a=cr())!==u){if(l=Vt,i=[],(f=qr())!==u)for(;f!==u;)i.push(f),f=qr();else i=u;if(i!==u&&(f=gr())!==u?(Lt=l,l=$t(0,0,f)):(Vt=l,l=u),l===u&&(l=null),i=Vt,f=[],(c=qr())!==u)for(;c!==u;)f.push(c),c=qr();else f=u;f!==u&&(c=br())!==u?(Lt=i,i=Nt(0,0,0,c)):(Vt=i,i=u),i===u&&(i=null),Lt=e,e=Dt(n,a,l,i)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;if(e===u)if(e=Vt,63===t.charCodeAt(Vt)?(r="?",Vt++):(r=u,0===Qt&&nr(Ve)),r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if((n=hr())!==u){if(o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;if(o!==u)if((a=hr())!==u){if(l=Vt,i=[],(f=qr())!==u)for(;f!==u;)i.push(f),f=qr();else i=u;if(i!==u&&(f=gr())!==u?(Lt=l,l=$t(0,0,f)):(Vt=l,l=u),l===u&&(l=null),i=Vt,f=[],(c=qr())!==u)for(;c!==u;)f.push(c),c=qr();else f=u;f!==u&&(c=br())!==u?(Lt=i,i=Nt(0,0,0,c)):(Vt=i,i=u),i===u&&(i=null),Lt=e,e=Dt(n,a,l,i)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;return Wt[h]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,h,y,x=70*Vt+61,m=Wt[x];if(m)return Vt=m.nextPos,m.result;e=Vt,t.substr(Vt,2)===X?(r=X,Vt+=2):(r=u,0===Qt&&nr(pt));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();for((n=Or())===u&&(n=null),o=[],a=qr();a!==u;)o.push(a),a=qr();if(41===t.charCodeAt(Vt)?(a=p,Vt++):(a=u,0===Qt&&nr(ve)),a!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();if(123===t.charCodeAt(Vt)?(i=v,Vt++):(i=u,0===Qt&&nr(ye)),i!==u){for(f=[],c=qr();c!==u;)f.push(c),c=qr();for((c=lr())===u&&(c=null),h=[],y=qr();y!==u;)h.push(y),y=qr();125===t.charCodeAt(Vt)?(y=d,Vt++):(y=u,0===Qt&&nr(xe)),y!==u?(Lt=e,e=zr("fn",{args:n},c||[])):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u;return Wt[x]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,h,p,y,x,m,g,A=70*Vt+39,b=Wt[A];if(b)return Vt=b.nextPos,b.result;e=Vt,t.substr(Vt,5)===T?(r=T,Vt+=5):(r=u,0===Qt&&nr(Ge));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if((n=hr())!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();if(123===t.charCodeAt(Vt)?(a=v,Vt++):(a=u,0===Qt&&nr(ye)),a!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();if(i=[],f=Vt,(c=hr())!==u){for(h=[],p=qr();p!==u;)h.push(p),p=qr();if(t.substr(Vt,2)===I?(p=I,Vt+=2):(p=u,0===Qt&&nr(Je)),p!==u){for(y=[],x=qr();x!==u;)y.push(x),x=qr();if((x=hr())!==u){for(m=[],g=qr();g!==u;)m.push(g),g=qr();Lt=f,f=Ft(0,c,x)}else Vt=f,f=u}else Vt=f,f=u}else Vt=f,f=u;if(f!==u)for(;f!==u;)if(i.push(f),f=Vt,(c=hr())!==u){for(h=[],p=qr();p!==u;)h.push(p),p=qr();if(t.substr(Vt,2)===I?(p=I,Vt+=2):(p=u,0===Qt&&nr(Je)),p!==u){for(y=[],x=qr();x!==u;)y.push(x),x=qr();if((x=hr())!==u){for(m=[],g=qr();g!==u;)m.push(g),g=qr();Lt=f,f=Ft(0,c,x)}else Vt=f,f=u}else Vt=f,f=u}else Vt=f,f=u;else i=u;if(i!==u){if(f=Vt,42===t.charCodeAt(Vt)?(c="*",Vt++):(c=u,0===Qt&&nr(Ke)),c!==u){for(h=[],p=qr();p!==u;)h.push(p),p=qr();if(t.substr(Vt,2)===I?(p=I,Vt+=2):(p=u,0===Qt&&nr(Je)),p!==u){for(y=[],x=qr();x!==u;)y.push(x),x=qr();if((x=hr())!==u){for(m=[],g=qr();g!==u;)m.push(g),g=qr();Lt=f,f=x}else Vt=f,f=u}else Vt=f,f=u}else Vt=f,f=u;for(f===u&&(f=null),c=[],h=qr();h!==u;)c.push(h),h=qr();125===t.charCodeAt(Vt)?(h=d,Vt++):(h=u,0===Qt&&nr(xe)),h!==u?(Lt=e,e=zr("match",{about:n,qs:i||[],default:f})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u;return Wt[A]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l=70*Vt+40,i=Wt[l];if(i)return Vt=i.nextPos,i.result;e=Vt,123===t.charCodeAt(Vt)?(r=v,Vt++):(r=u,0===Qt&&nr(ye));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if((n=lr())!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();125===t.charCodeAt(Vt)?(a=d,Vt++):(a=u,0===Qt&&nr(xe)),a!==u?(Lt=e,e=zr("block",{statements:n})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r=70*Vt+12,s=Wt[r];if(s)return Vt=s.nextPos,s.result;(e=Pr())===u&&(e=_r())===u&&(e=Sr())===u&&(e=jr())===u&&(e=Mr())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,h,p,y,x,m=70*Vt+57,g=Wt[m];if(g)return Vt=g.nextPos,g.result;e=Vt,123===t.charCodeAt(Vt)?(r=v,Vt++):(r=u,0===Qt&&nr(ye));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(n=[],o=Vt,(a=$r())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();if(58===t.charCodeAt(Vt)?(i=Q,Vt++):(i=u,0===Qt&&nr(ft)),i!==u){if(f=[],(c=qr())!==u)for(;c!==u;)f.push(c),c=qr();else f=u;if(f!==u)if((c=hr())!==u){for(h=[],p=qr();p!==u;)h.push(p),p=qr();for(44===t.charCodeAt(Vt)?(p=k,Vt++):(p=u,0===Qt&&nr(Me)),p===u&&(59===t.charCodeAt(Vt)?(p=W,Vt++):(p=u,0===Qt&&nr(ct))),p===u&&(p=null),y=[],x=qr();x!==u;)y.push(x),x=qr();Lt=o,o=Jt(a,c)}else Vt=o,o=u;else Vt=o,o=u}else Vt=o,o=u}else Vt=o,o=u;for(;o!==u;)if(n.push(o),o=Vt,(a=$r())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();if(58===t.charCodeAt(Vt)?(i=Q,Vt++):(i=u,0===Qt&&nr(ft)),i!==u){if(f=[],(c=qr())!==u)for(;c!==u;)f.push(c),c=qr();else f=u;if(f!==u)if((c=hr())!==u){for(h=[],p=qr();p!==u;)h.push(p),p=qr();for(44===t.charCodeAt(Vt)?(p=k,Vt++):(p=u,0===Qt&&nr(Me)),p===u&&(59===t.charCodeAt(Vt)?(p=W,Vt++):(p=u,0===Qt&&nr(ct))),p===u&&(p=null),y=[],x=qr();x!==u;)y.push(x),x=qr();Lt=o,o=Jt(a,c)}else Vt=o,o=u;else Vt=o,o=u}else Vt=o,o=u}else Vt=o,o=u;125===t.charCodeAt(Vt)?(o=d,Vt++):(o=u,0===Qt&&nr(xe)),o!==u?(Lt=e,e=Zt(n)):(Vt=e,e=u)}else Vt=e,e=u;return Wt[m]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,h=70*Vt+58,p=Wt[h];if(p)return Vt=p.nextPos,p.result;e=Vt,91===t.charCodeAt(Vt)?(r=H,Vt++):(r=u,0===Qt&&nr(ze));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(n=[],o=Vt,(a=hr())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();for(44===t.charCodeAt(Vt)?(i=k,Vt++):(i=u,0===Qt&&nr(Me)),i===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();Lt=o,o=a}else Vt=o,o=u;for(;o!==u;)if(n.push(o),o=Vt,(a=hr())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();for(44===t.charCodeAt(Vt)?(i=k,Vt++):(i=u,0===Qt&&nr(Me)),i===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();Lt=o,o=a}else Vt=o,o=u;for(o=[],a=qr();a!==u;)o.push(a),a=qr();93===t.charCodeAt(Vt)?(a=P,Vt++):(a=u,0===Qt&&nr(ke)),a!==u?(Lt=e,e=Bt(n)):(Vt=e,e=u)}else Vt=e,e=u;return Wt[h]={nextPos:Vt,result:e},e}());return Wt[r]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i=70*Vt+41,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,(r=Nr())!==u)if(40===t.charCodeAt(Vt)?(s=h,Vt++):(s=u,0===Qt&&nr(pe)),s!==u){for(n=[],o=qr();o!==u;)n.push(o),o=qr();for((o=Cr())===u&&(o=null),a=[],l=qr();l!==u;)a.push(l),l=qr();41===t.charCodeAt(Vt)?(l=p,Vt++):(l=u,0===Qt&&nr(ve)),l!==u?(Lt=e,e=zr("call",{name:r,args:o||[]})):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u;return Wt[i]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i=70*Vt+43,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,(r=Nr())!==u)if(91===t.charCodeAt(Vt)?(s=H,Vt++):(s=u,0===Qt&&nr(ze)),s!==u){for(n=[],o=qr();o!==u;)n.push(o),o=qr();if((o=hr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();93===t.charCodeAt(Vt)?(l=P,Vt++):(l=u,0===Qt&&nr(ke)),l!==u?(Lt=e,e=zr("index",{arr:r,i:o})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;return Wt[i]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f=70*Vt+44,c=Wt[f];if(c)return Vt=c.nextPos,c.result;if(e=Vt,(r=Nr())!==u){if(s=[],n=Vt,46===t.charCodeAt(Vt)?(o=D,Vt++):(o=u,0===Qt&&nr(Ie)),o!==u&&(a=$r())!==u?(Lt=n,n=Ot(0,a)):(Vt=n,n=u),n!==u)for(;n!==u;)s.push(n),n=Vt,46===t.charCodeAt(Vt)?(o=D,Vt++):(o=u,0===Qt&&nr(Ie)),o!==u&&(a=$r())!==u?(Lt=n,n=Ot(0,a)):(Vt=n,n=u);else s=u;if(s!==u)if(40===t.charCodeAt(Vt)?(n=h,Vt++):(n=u,0===Qt&&nr(pe)),n!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();for((a=Cr())===u&&(a=null),l=[],i=qr();i!==u;)l.push(i),i=qr();41===t.charCodeAt(Vt)?(i=p,Vt++):(i=u,0===Qt&&nr(ve)),i!==u?(Lt=e,e=zr("propCall",{obj:r,path:s,args:a||[]})):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;return Wt[f]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l=70*Vt+45,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,(r=Nr())!==u){if(s=[],n=Vt,46===t.charCodeAt(Vt)?(o=D,Vt++):(o=u,0===Qt&&nr(Ie)),o!==u&&(a=$r())!==u?(Lt=n,n=Ot(0,a)):(Vt=n,n=u),n!==u)for(;n!==u;)s.push(n),n=Vt,46===t.charCodeAt(Vt)?(o=D,Vt++):(o=u,0===Qt&&nr(Ie)),o!==u&&(a=$r())!==u?(Lt=n,n=Ot(0,a)):(Vt=n,n=u);else s=u;s!==u?(Lt=e,e=zr("prop",{obj:r,path:s})):(Vt=e,e=u)}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,t,r=70*Vt+46,s=Wt[r];if(s)return Vt=s.nextPos,s.result;e=Vt,(t=Nr())!==u&&(Lt=e,t=zr("var",{name:t}));return e=t,Wt[r]={nextPos:Vt,result:e},e}())===u)if(e=Vt,40===t.charCodeAt(Vt)?(r=h,Vt++):(r=u,0===Qt&&nr(pe)),r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if((n=hr())!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();41===t.charCodeAt(Vt)?(a=p,Vt++):(a=u,0===Qt&&nr(ve)),a!==u?(Lt=e,e=n):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}function vr(){var e,r=70*Vt+13,s=Wt[r];return s?(Vt=s.nextPos,s.result):((e=Sr())===u&&(e=_r())===u&&(e=jr())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,h=70*Vt+62,p=Wt[h];if(p)return Vt=p.nextPos,p.result;e=Vt,91===t.charCodeAt(Vt)?(r=H,Vt++):(r=u,0===Qt&&nr(ze));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(n=[],o=Vt,(a=vr())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();for(44===t.charCodeAt(Vt)?(i=k,Vt++):(i=u,0===Qt&&nr(Me)),i===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();Lt=o,o=a}else Vt=o,o=u;for(;o!==u;)if(n.push(o),o=Vt,(a=vr())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();for(44===t.charCodeAt(Vt)?(i=k,Vt++):(i=u,0===Qt&&nr(Me)),i===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();Lt=o,o=a}else Vt=o,o=u;for(o=[],a=qr();a!==u;)o.push(a),a=qr();93===t.charCodeAt(Vt)?(a=P,Vt++):(a=u,0===Qt&&nr(ke)),a!==u?(Lt=e,e=Bt(n)):(Vt=e,e=u)}else Vt=e,e=u;return Wt[h]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o,a,l,i,f,c,h,p,y,x,m=70*Vt+63,g=Wt[m];if(g)return Vt=g.nextPos,g.result;e=Vt,123===t.charCodeAt(Vt)?(r=v,Vt++):(r=u,0===Qt&&nr(ye));if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if(n=[],o=Vt,(a=$r())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();if(58===t.charCodeAt(Vt)?(i=Q,Vt++):(i=u,0===Qt&&nr(ft)),i!==u){if(f=[],(c=qr())!==u)for(;c!==u;)f.push(c),c=qr();else f=u;if(f!==u)if((c=vr())!==u){for(h=[],p=qr();p!==u;)h.push(p),p=qr();for(44===t.charCodeAt(Vt)?(p=k,Vt++):(p=u,0===Qt&&nr(Me)),p===u&&(59===t.charCodeAt(Vt)?(p=W,Vt++):(p=u,0===Qt&&nr(ct))),p===u&&(p=null),y=[],x=qr();x!==u;)y.push(x),x=qr();Lt=o,o=Jt(a,c)}else Vt=o,o=u;else Vt=o,o=u}else Vt=o,o=u}else Vt=o,o=u;for(;o!==u;)if(n.push(o),o=Vt,(a=$r())!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();if(58===t.charCodeAt(Vt)?(i=Q,Vt++):(i=u,0===Qt&&nr(ft)),i!==u){if(f=[],(c=qr())!==u)for(;c!==u;)f.push(c),c=qr();else f=u;if(f!==u)if((c=vr())!==u){for(h=[],p=qr();p!==u;)h.push(p),p=qr();for(44===t.charCodeAt(Vt)?(p=k,Vt++):(p=u,0===Qt&&nr(Me)),p===u&&(59===t.charCodeAt(Vt)?(p=W,Vt++):(p=u,0===Qt&&nr(ct))),p===u&&(p=null),y=[],x=qr();x!==u;)y.push(x),x=qr();Lt=o,o=Jt(a,c)}else Vt=o,o=u;else Vt=o,o=u}else Vt=o,o=u}else Vt=o,o=u;125===t.charCodeAt(Vt)?(o=d,Vt++):(o=u,0===Qt&&nr(xe)),o!==u?(Lt=e,e=Zt(n)):(Vt=e,e=u)}else Vt=e,e=u;return Wt[m]={nextPos:Vt,result:e},e}())===u&&(e=Mr()),Wt[r]={nextPos:Vt,result:e},e)}function dr(){var e,r,s,n,o,a,l,i,f,c,h=70*Vt+14,p=Wt[h];if(p)return Vt=p.nextPos,p.result;if(e=Vt,"::"===t.substr(Vt,2)?(r="::",Vt+=2):(r=u,0===Qt&&nr(de)),r!==u){if(s=[],(n=qr())!==u)for(;n!==u;)s.push(n),n=qr();else s=u;if(s!==u)if((n=$r())!==u){if(o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;if(o!==u)if(123===t.charCodeAt(Vt)?(a=v,Vt++):(a=u,0===Qt&&nr(ye)),a!==u){for(l=[],i=qr();i!==u;)l.push(i),i=qr();for((i=function(){var e,t,r,s,n,o,a,l,i=70*Vt+5,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,(t=fr())!==u){for(r=[],s=Vt,n=[],o=Fr();o!==u;)n.push(o),o=Fr();if((o=Dr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=fr())!==u?(Lt=s,s=Pt(0,l)):(Vt=s,s=u)}else Vt=s,s=u;for(;s!==u;){for(r.push(s),s=Vt,n=[],o=Fr();o!==u;)n.push(o),o=Fr();if((o=Dr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=fr())!==u?(Lt=s,s=Pt(0,l)):(Vt=s,s=u)}else Vt=s,s=u}Lt=e,e=wt(t,r)}else Vt=e,e=u;return Wt[i]={nextPos:Vt,result:e},e}())===u&&(i=null),f=[],c=qr();c!==u;)f.push(c),c=qr();125===t.charCodeAt(Vt)?(c=d,Vt++):(c=u,0===Qt&&nr(xe)),c!==u?(Lt=e,e=zr("ns",{name:n,members:i})):(Vt=e,e=u)}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u}else Vt=e,e=u;return Wt[h]={nextPos:Vt,result:e},e}function yr(){var e,r,s,n,o,a,l,i=70*Vt+16,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,35===t.charCodeAt(Vt)?(r=x,Vt++):(r=u,0===Qt&&nr(ge)),r!==u)if((s=$r())!==u){for(n=[],o=qr();o!==u;)n.push(o),o=qr();if(61===t.charCodeAt(Vt)?(o=m,Vt++):(o=u,0===Qt&&nr(Ae)),o!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=hr())!==u?(Lt=e,e=zr("def",{name:s,expr:l,mut:!1,attr:[]})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;if(e===u)if(e=Vt,36===t.charCodeAt(Vt)?(r="$",Vt++):(r=u,0===Qt&&nr(be)),r!==u)if((s=$r())!==u){for(n=[],o=qr();o!==u;)n.push(o),o=qr();if(t.substr(Vt,2)===g?(o=g,Vt+=2):(o=u,0===Qt&&nr(Ce)),o!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=hr())!==u?(Lt=e,e=function(e,t){return zr("def",{name:e,expr:t,mut:!0,attr:[]})}(s,l)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;return Wt[i]={nextPos:Vt,result:e},e}function xr(){var e,r,s,n=70*Vt+32,o=Wt[n];return o?(Vt=o.nextPos,o.result):(e=Vt,92===t.charCodeAt(Vt)?(r="\\",Vt++):(r=u,0===Qt&&nr(Te)),r!==u&&(s=Dr())!==u?e=r=[r,s]:(Vt=e,e=u),e===u&&(e=Fr()),Wt[n]={nextPos:Vt,result:e},e)}function mr(){var e,r,s,n,o,a,l=70*Vt+34,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,r=Vt,Qt++,s=Vt,(n=function(){var e,r=70*Vt+33,s=Wt[r];return s?(Vt=s.nextPos,s.result):(t.substr(Vt,3)===b?(e=b,Vt+=3):(e=u,0===Qt&&nr(we)),e===u&&(t.substr(Vt,2)===I?(e=I,Vt+=2):(e=u,0===Qt&&nr(Je)),e===u&&(t.substr(Vt,2)===g?(e=g,Vt+=2):(e=u,0===Qt&&nr(Ce)),e===u&&(t.substr(Vt,3)===q?(e=q,Vt+=3):(e=u,0===Qt&&nr(Ue)),e===u&&(t.substr(Vt,3)===F?(e=F,Vt+=3):(e=u,0===Qt&&nr(Re)))))),Wt[r]={nextPos:Vt,result:e},e)}())!==u?(o=Vt,Qt++,te.test(t.charAt(Vt))?(a=t.charAt(Vt),Vt++):(a=u,0===Qt&&nr(Ze)),Qt--,a===u?o=void 0:(Vt=o,o=u),o!==u?s=n=[n,o]:(Vt=s,s=u)):(Vt=s,s=u),Qt--,s===u?r=void 0:(Vt=r,r=u),r!==u){if(s=[],te.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(Ze)),n!==u)for(;n!==u;)s.push(n),te.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(Ze));else s=u;s!==u?(Lt=e,e=zr("operator",{op:Xt()})):(Vt=e,e=u)}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}function gr(){var e,t,r,s,n,o,a=70*Vt+36,l=Wt[a];if(l)return Vt=l.nextPos,l.result;if(e=Vt,(t=Ar())!==u){for(r=[],s=Vt,n=[],o=qr();o!==u;)n.push(o),o=qr();for((o=Ar())!==u?(Lt=s,s=Ht(0,o)):(Vt=s,s=u);s!==u;){for(r.push(s),s=Vt,n=[],o=qr();o!==u;)n.push(o),o=qr();(o=Ar())!==u?(Lt=s,s=Ht(0,o)):(Vt=s,s=u)}Lt=e,e=wt(t,r)}else Vt=e,e=u;return Wt[a]={nextPos:Vt,result:e},e}function Ar(){var e,r,s,n,o,a,l,i=70*Vt+37,f=Wt[i];if(f)return Vt=f.nextPos,f.result;if(e=Vt,t.substr(Vt,4)===U?(r=U,Vt+=4):(r=u,0===Qt&&nr(Le)),r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();if((n=hr())!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();(a=cr())!==u?(Lt=e,e=qt(n,a)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;if(e===u){if(e=Vt,r=[],46===t.charCodeAt(Vt)?(s=D,Vt++):(s=u,0===Qt&&nr(Ie)),s!==u)for(;s!==u;)r.push(s),46===t.charCodeAt(Vt)?(s=D,Vt++):(s=u,0===Qt&&nr(Ie));else r=u;if(r!==u)if(63===t.charCodeAt(Vt)?(s="?",Vt++):(s=u,0===Qt&&nr(Ve)),s!==u){for(n=[],o=qr();o!==u;)n.push(o),o=qr();if((o=hr())!==u){for(a=[],l=qr();l!==u;)a.push(l),l=qr();(l=cr())!==u?(Lt=e,e=qt(o,l)):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u}return Wt[i]={nextPos:Vt,result:e},e}function br(){var e,r,s,n,o=70*Vt+38,a=Wt[o];if(a)return Vt=a.nextPos,a.result;if(e=Vt,t.substr(Vt,4)===R?(r=R,Vt+=4):(r=u,0===Qt&&nr(Ye)),r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();(n=cr())!==u?(Lt=e,e=n):(Vt=e,e=u)}else Vt=e,e=u;if(e===u){if(e=Vt,r=[],46===t.charCodeAt(Vt)?(s=D,Vt++):(s=u,0===Qt&&nr(Ie)),s!==u)for(;s!==u;)r.push(s),46===t.charCodeAt(Vt)?(s=D,Vt++):(s=u,0===Qt&&nr(Ie));else r=u;if(r!==u){for(s=[],n=qr();n!==u;)s.push(n),n=qr();(n=cr())!==u?(Lt=e,e=n):(Vt=e,e=u)}else Vt=e,e=u}return Wt[o]={nextPos:Vt,result:e},e}function Cr(){var e,r,s,n,o,a,l=70*Vt+42,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,(r=hr())!==u){if(s=[],n=Vt,44===t.charCodeAt(Vt)?Vt++:0===Qt&&nr(Me),o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;for(o!==u&&(a=hr())!==u?(Lt=n,n=It(0,a)):(Vt=n,n=u);n!==u;){if(s.push(n),n=Vt,44===t.charCodeAt(Vt)?Vt++:0===Qt&&nr(Me),o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;o!==u&&(a=hr())!==u?(Lt=n,n=It(0,a)):(Vt=n,n=u)}Lt=e,e=wt(r,s)}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}function Pr(){var e,r,s,n,o,a,l=70*Vt+47,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,96===t.charCodeAt(Vt)?(r=J,Vt++):(r=u,0===Qt&&nr(Qe)),r!==u){for(s=[],n=Vt,o=Vt,Qt++,96===t.charCodeAt(Vt)?(a=J,Vt++):(a=u,0===Qt&&nr(Qe)),Qt--,a===u?o=void 0:(Vt=o,o=u),o!==u&&(a=wr())!==u?(Lt=n,n=a):(Vt=n,n=u);n!==u;)s.push(n),n=Vt,o=Vt,Qt++,96===t.charCodeAt(Vt)?(a=J,Vt++):(a=u,0===Qt&&nr(Qe)),Qt--,a===u?o=void 0:(Vt=o,o=u),o!==u&&(a=wr())!==u?(Lt=n,n=a):(Vt=n,n=u);96===t.charCodeAt(Vt)?(n=J,Vt++):(n=u,0===Qt&&nr(Qe)),n!==u?(Lt=e,e=zr("tmpl",{tmpl:Ir(s)})):(Vt=e,e=u)}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}function wr(){var e,r,s,n,o,a,l=70*Vt+48,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if((e=function(){var e,r,s=70*Vt+49,n=Wt[s];if(n)return Vt=n.nextPos,n.result;e=Vt,t.substr(Vt,2)===Z?(r=Z,Vt+=2):(r=u,0===Qt&&nr(We));r!==u&&(Lt=e,r=zt());(e=r)===u&&(e=Vt,t.substr(Vt,2)===B?(r=B,Vt+=2):(r=u,0===Qt&&nr(Xe)),r!==u&&(Lt=e,r=zt()),(e=r)===u&&(e=Vt,t.substr(Vt,2)===V?(r=V,Vt+=2):(r=u,0===Qt&&nr(et)),r!==u&&(Lt=e,r="`"),e=r));return Wt[s]={nextPos:Vt,result:e},e}())===u){if(e=Vt,123===t.charCodeAt(Vt)?(r=v,Vt++):(r=u,0===Qt&&nr(ye)),r!==u){for(s=[],n=Fr();n!==u;)s.push(n),n=Fr();if((n=hr())!==u){for(o=[],a=Fr();a!==u;)o.push(a),a=Fr();125===t.charCodeAt(Vt)?(a=d,Vt++):(a=u,0===Qt&&nr(xe)),a!==u?(Lt=e,e=n):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u;e===u&&(t.length>Vt?(e=t.charAt(Vt),Vt++):(e=u,0===Qt&&nr(ce)))}return Wt[l]={nextPos:Vt,result:e},e}function _r(){var e,r,s,n,o,a,l=70*Vt+50,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,34===t.charCodeAt(Vt)?(r=L,Vt++):(r=u,0===Qt&&nr(tt)),r!==u){for(s=[],n=Vt,o=Vt,Qt++,34===t.charCodeAt(Vt)?(a=L,Vt++):(a=u,0===Qt&&nr(tt)),Qt--,a===u?o=void 0:(Vt=o,o=u),o!==u?((a=kr())===u&&(t.length>Vt?(a=t.charAt(Vt),Vt++):(a=u,0===Qt&&nr(ce))),a!==u?(Lt=n,n=a):(Vt=n,n=u)):(Vt=n,n=u);n!==u;)s.push(n),n=Vt,o=Vt,Qt++,34===t.charCodeAt(Vt)?(a=L,Vt++):(a=u,0===Qt&&nr(tt)),Qt--,a===u?o=void 0:(Vt=o,o=u),o!==u?((a=kr())===u&&(t.length>Vt?(a=t.charAt(Vt),Vt++):(a=u,0===Qt&&nr(ce))),a!==u?(Lt=n,n=a):(Vt=n,n=u)):(Vt=n,n=u);34===t.charCodeAt(Vt)?(n=L,Vt++):(n=u,0===Qt&&nr(tt)),n!==u?(Lt=e,e=zr("str",{value:s.join("")})):(Vt=e,e=u)}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}function kr(){var e,r,s=70*Vt+51,n=Wt[s];return n?(Vt=n.nextPos,n.result):(e=Vt,'\\"'===t.substr(Vt,2)?(r='\\"',Vt+=2):(r=u,0===Qt&&nr(rt)),r!==u&&(Lt=e,r='"'),e=r,Wt[s]={nextPos:Vt,result:e},e)}function Sr(){var e,r,s,n,o=70*Vt+52,a=Wt[o];if(a)return Vt=a.nextPos,a.result;if(e=Vt,re.test(t.charAt(Vt))?(t.charAt(Vt),Vt++):0===Qt&&nr(st),ne.test(t.charAt(Vt))?(r=t.charAt(Vt),Vt++):(r=u,0===Qt&&nr(nt)),r!==u){if(s=[],oe.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(ot)),n!==u)for(;n!==u;)s.push(n),oe.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(ot));else s=u;s!==u?(Lt=e,e=Ut()):(Vt=e,e=u)}else Vt=e,e=u;return e===u&&(e=Vt,re.test(t.charAt(Vt))?(t.charAt(Vt),Vt++):0===Qt&&nr(st),oe.test(t.charAt(Vt))?(r=t.charAt(Vt),Vt++):(r=u,0===Qt&&nr(ot)),r!==u?(Lt=e,e=Ut()):(Vt=e,e=u)),Wt[o]={nextPos:Vt,result:e},e}function jr(){var e,r=70*Vt+53,s=Wt[r];return s?(Vt=s.nextPos,s.result):((e=function(){var e,r,s,n,o=70*Vt+54,a=Wt[o];if(a)return Vt=a.nextPos,a.result;e=Vt,t.substr(Vt,3)===Y?(r=Y,Vt+=3):(r=u,0===Qt&&nr(at));r!==u?(s=Vt,Qt++,ee.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(qe)),Qt--,n===u?s=void 0:(Vt=s,s=u),s!==u?(Lt=e,e=Rt()):(Vt=e,e=u)):(Vt=e,e=u);e===u&&(e=Vt,43===t.charCodeAt(Vt)?(r=w,Vt++):(r=u,0===Qt&&nr(Se)),r!==u?(s=Vt,Qt++,ee.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(qe)),Qt--,n===u?s=void 0:(Vt=s,s=u),s!==u?(Lt=e,e=Rt()):(Vt=e,e=u)):(Vt=e,e=u));return Wt[o]={nextPos:Vt,result:e},e}())===u&&(e=function(){var e,r,s,n,o=70*Vt+55,a=Wt[o];if(a)return Vt=a.nextPos,a.result;e=Vt,t.substr(Vt,2)===G?(r=G,Vt+=2):(r=u,0===Qt&&nr(ut));r!==u?(s=Vt,Qt++,ee.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(qe)),Qt--,n===u?s=void 0:(Vt=s,s=u),s!==u?(Lt=e,e=Tt()):(Vt=e,e=u)):(Vt=e,e=u);e===u&&(e=Vt,45===t.charCodeAt(Vt)?(r="-",Vt++):(r=u,0===Qt&&nr(lt)),r!==u?(s=Vt,Qt++,ee.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(qe)),Qt--,n===u?s=void 0:(Vt=s,s=u),s!==u?(Lt=e,e=Tt()):(Vt=e,e=u)):(Vt=e,e=u));return Wt[o]={nextPos:Vt,result:e},e}()),Wt[r]={nextPos:Vt,result:e},e)}function Mr(){var e,r,s,n,o=70*Vt+56,a=Wt[o];return a?(Vt=a.nextPos,a.result):(e=Vt,t.substr(Vt,4)===K?(r=K,Vt+=4):(r=u,0===Qt&&nr(it)),r!==u?(s=Vt,Qt++,ee.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(qe)),Qt--,n===u?s=void 0:(Vt=s,s=u),s!==u?(Lt=e,e=zr("null",{})):(Vt=e,e=u)):(Vt=e,e=u),Wt[o]={nextPos:Vt,result:e},e)}function Or(){var e,r,s,n,o,a,l=70*Vt+59,i=Wt[l];if(i)return Vt=i.nextPos,i.result;if(e=Vt,(r=$r())!==u){if(s=[],n=Vt,44===t.charCodeAt(Vt)?Vt++:0===Qt&&nr(Me),o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;for(o!==u&&(a=$r())!==u?(Lt=n,n=Ot(0,a)):(Vt=n,n=u);n!==u;){if(s.push(n),n=Vt,44===t.charCodeAt(Vt)?Vt++:0===Qt&&nr(Me),o=[],(a=qr())!==u)for(;a!==u;)o.push(a),a=qr();else o=u;o!==u&&(a=$r())!==u?(Lt=n,n=Ot(0,a)):(Vt=n,n=u)}Lt=e,e=wt(r,s)}else Vt=e,e=u;return Wt[l]={nextPos:Vt,result:e},e}function Er(){var e,r,s,n,o,a,l,i,f,c,y,x,m,g,A=70*Vt+60,b=Wt[A];if(b)return Vt=b.nextPos,b.result;if(e=Vt,64===t.charCodeAt(Vt)?(r="@",Vt++):(r=u,0===Qt&&nr(ht)),r!==u)if((s=$r())!==u)if(40===t.charCodeAt(Vt)?(n=h,Vt++):(n=u,0===Qt&&nr(pe)),n!==u){for(o=[],a=qr();a!==u;)o.push(a),a=qr();for((a=Or())===u&&(a=null),l=[],i=qr();i!==u;)l.push(i),i=qr();if(41===t.charCodeAt(Vt)?(i=p,Vt++):(i=u,0===Qt&&nr(ve)),i!==u){for(f=[],c=qr();c!==u;)f.push(c),c=qr();if(123===t.charCodeAt(Vt)?(c=v,Vt++):(c=u,0===Qt&&nr(ye)),c!==u){for(y=[],x=qr();x!==u;)y.push(x),x=qr();for((x=lr())===u&&(x=null),m=[],g=qr();g!==u;)m.push(g),g=qr();125===t.charCodeAt(Vt)?(g=d,Vt++):(g=u,0===Qt&&nr(xe)),g!==u?(Lt=e,e=zr("def",{name:s,expr:zr("fn",{args:a},x||[]),mut:!1,attr:[]})):(Vt=e,e=u)}else Vt=e,e=u}else Vt=e,e=u}else Vt=e,e=u;else Vt=e,e=u;else Vt=e,e=u;return Wt[A]={nextPos:Vt,result:e},e}function $r(){var e,r,s,n,o=70*Vt+64,a=Wt[o];if(a)return Vt=a.nextPos,a.result;if(e=Vt,ae.test(t.charAt(Vt))?(r=t.charAt(Vt),Vt++):(r=u,0===Qt&&nr(vt)),r!==u){for(s=[],ue.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(dt));n!==u;)s.push(n),ue.test(t.charAt(Vt))?(n=t.charAt(Vt),Vt++):(n=u,0===Qt&&nr(dt));Lt=e,e=bt()}else Vt=e,e=u;return Wt[o]={nextPos:Vt,result:e},e}function Nr(){var e,r,s,n,o,a=70*Vt+65,l=Wt[a];if(l)return Vt=l.nextPos,l.result;if(e=Vt,$r()!==u){for(r=[],s=Vt,58===t.charCodeAt(Vt)?(n=Q,Vt++):(n=u,0===Qt&&nr(ft)),n!==u&&(o=$r())!==u?s=n=[n,o]:(Vt=s,s=u);s!==u;)r.push(s),s=Vt,58===t.charCodeAt(Vt)?(n=Q,Vt++):(n=u,0===Qt&&nr(ft)),n!==u&&(o=$r())!==u?s=n=[n,o]:(Vt=s,s=u);Lt=e,e=bt()}else Vt=e,e=u;return Wt[a]={nextPos:Vt,result:e},e}function Dr(){var e,r=70*Vt+66,s=Wt[r];return s?(Vt=s.nextPos,s.result):("\r\n"===t.substr(Vt,2)?(e="\r\n",Vt+=2):(e=u,0===Qt&&nr(yt)),e===u&&(le.test(t.charAt(Vt))?(e=t.charAt(Vt),Vt++):(e=u,0===Qt&&nr(xt))),Wt[r]={nextPos:Vt,result:e},e)}function Hr(){var e,r,s=70*Vt+67,n=Wt[s];return n?(Vt=n.nextPos,n.result):(e=Vt,Qt++,t.length>Vt?(r=t.charAt(Vt),Vt++):(r=u,0===Qt&&nr(ce)),Qt--,r===u?e=void 0:(Vt=e,e=u),e===u&&(e=Dr()),Wt[s]={nextPos:Vt,result:e},e)}function qr(){var e,r=70*Vt+68,s=Wt[r];return s?(Vt=s.nextPos,s.result):(ie.test(t.charAt(Vt))?(e=t.charAt(Vt),Vt++):(e=u,0===Qt&&nr(mt)),Wt[r]={nextPos:Vt,result:e},e)}function Fr(){var e,r=70*Vt+69,s=Wt[r];return s?(Vt=s.nextPos,s.result):(fe.test(t.charAt(Vt))?(e=t.charAt(Vt),Vt++):(e=u,0===Qt&&nr(gt)),Wt[r]={nextPos:Vt,result:e},e)}function Ir(e){let t=function(e,t){const r=[];for(let s=0;s<e.length;s++)0!=s&&t(e[s-1],e[s])?r[r.length-1].push(e[s]):r.push([e[s]]);return r}(e,((e,t)=>typeof t==typeof e));return t=t.map((e=>"string"==typeof e[0]?[e.join("")]:e)),function(e){return e.reduce(((e,t)=>e.concat(t)),[])}(t)}function zr(e,t,r){const s={type:e};t.children=r;for(const o of Object.keys(t))void 0!==t[o]&&(s[o]=t[o]);const n=sr(Lt,Vt);return s.loc={start:n.start.offset,end:n.end.offset-1},s}if((s=f())!==u&&Vt===t.length)return s;throw s!==u&&Vt<t.length&&nr({type:"end"}),n=Kt,o=Gt<t.length?t.charAt(Gt):null,a=Gt<t.length?sr(Gt,Gt+1):sr(Gt,Gt),new se(se.buildMessage(n,o),n,o,a)}};function oe(e){const t=[],r=[];for(const s of e)if("attr"==s.type)r.push(s);else if("def"==s.type)s.attr.push(...r),r.splice(0,r.length),"fn"==s.expr.type&&(s.expr.children=oe(s.expr.children)),t.push(s);else{if(r.length>0)throw new pe("invalid attribute.");switch(s.type){case"fn":s.children=oe(s.children);break;case"block":s.statements=oe(s.statements)}t.push(s)}if(r.length>0)throw new pe("invalid attribute.");return t}const ae=["null","yes","no","true","false","each","for","loop","while","break","continue","match","if","elif","else","return"];function ue(e){var t;for(const r of e)switch(r.type){case"def":case"assign":case"ns":if(ae.includes(r.name))throw new pe(`Reserved word "${r.name}" cannot be used as variable name.`);break;case"fn":ue(r.children);break;case"block":ue(r.statements);break;case"if":"block"==r.then.type&&ue(r.then.statements);for(const e of r.elseif)"block"==e.then.type&&ue(e.then.statements);"block"==(null==(t=r.else)?void 0:t.type)&&ue(r.else.statements)}return e}function le(e){ue(e.nodes);return oe(e.nodes)}const ie={def:0,assign:1,call:2,return:3,if:4,for:5,forOf:6,var:7,null:8,bool:9,num:10,str:11,arr:12,fn:13,obj:14,prop:15,propCall:16,index:17,block:18,tmpl:19,ns:20,match:21,meta:22,propAssign:23,indexAssign:24,inc:25,dec:26,attr:27,break:28,loop:29,continue:30,infix:31,operator:32};function fe(e){if(null==e)return null;switch(e.type){case"def":return[ie[e.type],e.name,e.mut,fe(e.expr),ce(e.attr)];case"assign":return[ie[e.type],e.name,fe(e.expr)];case"call":return[ie[e.type],e.name,ce(e.args)];case"return":return[ie[e.type],fe(e.expr)];case"if":return[ie[e.type],fe(e.cond),fe(e.then),e.elseif.map((e=>[fe(e.cond),fe(e.then)])),fe(e.else)];case"for":return[ie[e.type],e.var,fe(e.from),fe(e.to),fe(e.times),fe(e.for)];case"forOf":return[ie[e.type],e.var,fe(e.items),fe(e.for)];case"var":return[ie[e.type],e.name];case"null":return[ie[e.type]];case"bool":case"num":case"str":return[ie[e.type],e.value];case"arr":return[ie[e.type],ce(e.value)];case"fn":return[ie[e.type],e.args,ce(e.children)];case"obj":return[ie[e.type],Array.from(e.value.entries()).map((e=>[e[0],fe(e[1])]))];case"prop":return[ie[e.type],e.obj,e.path];case"propCall":return[ie[e.type],e.obj,e.path,ce(e.args)];case"index":return[ie[e.type],e.arr,fe(e.i)];case"block":return[ie[e.type],ce(e.statements)];case"tmpl":return[ie[e.type],e.tmpl.map((e=>"string"==typeof e?e:fe(e)))];case"ns":return[ie[e.type],e.name,ce(e.members)];case"match":return[ie[e.type],fe(e.about),e.qs.map((e=>[fe(e.q),fe(e.a)])),fe(e.default)];case"meta":return[ie[e.type],e.name,fe(e.value)];case"propAssign":return[ie[e.type],e.obj,e.path,fe(e.expr)];case"indexAssign":return[ie[e.type],e.arr,fe(e.i),fe(e.expr)];case"inc":case"dec":return[ie[e.type],e.name,fe(e.expr)];case"attr":return[ie[e.type],e.name,fe(e.value)];case"break":return[ie[e.type],null];case"loop":return[ie[e.type],ce(e.statements)];case"continue":return[ie[e.type],null];case"infix":return[ie[e.type],ce(e.operands),ce(e.operators)];case"operator":return[ie[e.type],e.op]}}function ce(e){return e.map((e=>fe(e)))}class he extends Error{constructor(e){let t="Syntax error.";e&&(t+=` ${e}`),super(t)}}class pe extends Error{constructor(e){let t="Semantic error.";e&&(t+=` ${e}`),super(t)}}const ve={id:"root"},de=x("h1",null,"AiScript (v0.11.1) Playground",-1),ye={id:"grid1"},xe={id:"editor",class:"container"},me=P("Input"),ge={key:0,class:"syntaxError"},Ae={id:"logs",class:"container"},be=x("header",null,"Output",-1),Ce={class:"type"},Pe={id:"grid2"},we={id:"ast",class:"container"},_e=x("header",null,"AST",-1),ke={id:"bin",class:"container"},Se=x("header",null,"Bytecode",-1),je=x("div",{id:"debugger",class:"container"},[x("header",null,"Debugger"),x("div")],-1);k({setup(e){const t=p(window.localStorage.getItem("script")||'<: "Hello, AiScript!"'),r=p(null),s=p(null),n=p([]),o=p(!1);v(t,(()=>{window.localStorage.setItem("script",t.value);try{r.value=le(function(e){let t;try{t=(void 0)(e)}catch(r){if(r.location)throw new he(`Line ${r.location.start.line}:${r.location.start.column}`);throw r}return{nodes:t}}(t.value)),o.value=!1}catch(e){return o.value=!0,void console.error(e)}s.value=ce(r.value)}),{immediate:!0});const a=()=>{t.value='for (#i, 100) {\n  <: if ((i % 15) = 0) "FizzBuzz"\n    elif ((i % 3) = 0) "Fizz"\n    elif ((i % 5) = 0) "Buzz"\n    else i\n}'},u=async()=>{n.value=[];const e=new re({},{in:e=>new Promise((t=>{t(window.prompt(e))})),out:e=>{n.value.push({id:Math.random(),type:e.type,text:"str"===e.type||"num"===e.type?e.value:G(e),print:!0})},log:(e,t)=>{switch(e){case"end":n.value.push({id:Math.random(),text:G(t.val,!0),print:!1})}}});try{await e.exec(r.value)}catch(t){console.error(t),window.alert("Error: "+t)}},l=e=>w.exports.highlight(e,w.exports.languages.js,"javascript");return(e,i)=>(d(),y("div",ve,[de,x("div",ye,[x("div",xe,[x("header",null,[me,x("div",{class:"actions"},[x("button",{onClick:a},"FizzBuzz")])]),x("div",null,[x(m(_),{class:"code",modelValue:t.value,"onUpdate:modelValue":i[1]||(i[1]=e=>t.value=e),highlight:l,"line-numbers":!1},null,8,["modelValue"])]),x("footer",null,[o.value?(d(),y("span",ge,"Syntax Error!")):g("",!0),x("div",{class:"actions"},[x("button",{onClick:u},"RUN")])])]),x("div",Ae,[be,x("div",null,[(d(!0),y(A,null,b(n.value,(e=>(d(),y("div",{class:["log",[{print:e.print},e.type]],key:e.id},[x("span",Ce,C(e.type),1),P(" "+C(e.text),1)],2)))),128))])])]),x("div",Pe,[x("div",we,[_e,x("div",null,[x("pre",null,C(JSON.stringify(r.value,null,"\t")),1)])]),x("div",ke,[Se,x("div",null,[x("code",null,C(JSON.stringify(s.value)),1)])]),je])]))}}).mount("#app");
